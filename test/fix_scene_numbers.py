"""
–ò—Å–ø—Ä–∞–≤–ª—è–µ–º –Ω—É–º–µ—Ä–∞—Ü–∏—é —Å—Ü–µ–Ω –≤ B1 —É—Ä–æ–∫–∞—Ö
–ù–æ–º–µ—Ä —Å—Ü–µ–Ω—ã = –Ω–æ–º–µ—Ä —É—Ä–æ–∫–∞ (1-15)
"""
import json
from pathlib import Path

# –ú–∞–ø–∏–Ω–≥: –Ω–æ–º–µ—Ä —É—Ä–æ–∫–∞ -> –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä —Å—Ü–µ–Ω—ã
SCENE_NUMBERS = {
    "01_–¢—Ä–æ–Ω–Ω—ã–π_–∑–∞–ª_B1.json": "1",
    "02_–ò—Å–ø—ã—Ç–∞–Ω–∏–µ_–ª—é–±–≤–∏_B1.json": "2", 
    "03_–ò–∑–≥–Ω–∞–Ω–∏–µ_–ö–æ—Ä–¥–µ–ª–∏–∏_B1.json": "3",
    "04_–ò–Ω—Ç—Ä–∏–≥–∞_–≠–¥–º—É–Ω–¥–∞_B1.json": "4",
    "05_–û–±–º–∞–Ω_–ì–ª–æ—Å—Ç–µ—Ä–∞_B1.json": "5",
    "06_–£–Ω–∏–∂–µ–Ω–∏–µ_–õ–∏—Ä–∞_B1.json": "6",
    "07_–ë—É—Ä—è_–∏_–±–µ–∑—É–º–∏–µ_B1.json": "7",  # –ë—ã–ª–æ –°–¶–ï–ù–ê 2, —Å—Ç–∞–Ω–µ—Ç –°–¶–ï–ù–ê 7
    "08_–í—Å—Ç—Ä–µ—á–∞_—Å_–¢–æ–º–æ–º_B1.json": "8",  # –ë—ã–ª–æ –°–¶–ï–ù–ê 4, —Å—Ç–∞–Ω–µ—Ç –°–¶–ï–ù–ê 8
    "09_–û—Å–ª–µ–ø–ª–µ–Ω–∏–µ_–ì–ª–æ—Å—Ç–µ—Ä–∞_B1.json": "9",  # –ë—ã–ª–æ –°–¶–ï–ù–ê 7, —Å—Ç–∞–Ω–µ—Ç –°–¶–ï–ù–ê 9
    "10_–î—É–≤—Ä—Å–∫–∏–µ_—Å–∫–∞–ª—ã_B1.json": "10",
    "11_–ü—Ä–∏–º–∏—Ä–µ–Ω–∏–µ_—Å_–ö–æ—Ä–¥–µ–ª–∏–µ–π_B1.json": "11",
    "12_–ü—Ä–æ–∑—Ä–µ–Ω–∏–µ_–õ–∏—Ä–∞_B1.json": "12",
    "13_–ë–∏—Ç–≤–∞_B1.json": "13",  # –ë—ã–ª–æ –°–¶–ï–ù–ê 2, —Å—Ç–∞–Ω–µ—Ç –°–¶–ï–ù–ê 13
    "14_–î—É—ç–ª—å_–±—Ä–∞—Ç—å–µ–≤_B1.json": "14",  # –ë—ã–ª–æ –°–¶–ï–ù–ê 3, —Å—Ç–∞–Ω–µ—Ç –°–¶–ï–ù–ê 14
    "15_–°–º–µ—Ä—Ç—å_–ö–æ—Ä–¥–µ–ª–∏–∏_–∏_–õ–∏—Ä–∞_B1.json": "15"  # –ë—ã–ª–æ –°–¶–ï–ù–ê 3, —Å—Ç–∞–Ω–µ—Ç –°–¶–ï–ù–ê 15
}

b1_dir = Path(r'F:\AiKlientBank\Lir\data\b1')
updated = 0

print("[INFO] –û–±–Ω–æ–≤–ª—è–µ–º –Ω–æ–º–µ—Ä–∞ —Å—Ü–µ–Ω (1-15):")
print("=" * 80)

for filename, scene_num in SCENE_NUMBERS.items():
    file_path = b1_dir / filename
    
    if not file_path.exists():
        print(f"[ERROR] –§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω: {filename}")
        continue
    
    with open(file_path, 'r', encoding='utf-8') as f:
        data = json.load(f)
    
    old_title = data.get('title', '')
    
    # –ò–∑–≤–ª–µ–∫–∞–µ–º –∞–∫—Ç –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ
    if '–ê–ö–¢' in old_title:
        parts = old_title.split(',')
        if len(parts) >= 2:
            act_part = parts[0]  # "üé≠ –ê–ö–¢ III"
            
            # –ò–∑–≤–ª–µ–∫–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–æ—Å–ª–µ –¥–≤–æ–µ—Ç–æ—á–∏—è
            if ':' in old_title:
                title_name = old_title.split(':')[-1].strip()
            else:
                title_name = parts[-1].strip()
            
            # –§–æ—Ä–º–∏—Ä—É–µ–º –Ω–æ–≤—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å –Ω–æ–º–µ—Ä–æ–º —Å—Ü–µ–Ω—ã = –Ω–æ–º–µ—Ä—É —É—Ä–æ–∫–∞
            new_title = f"{act_part}, –°–¶–ï–ù–ê {scene_num}: {title_name}"
            
            if old_title != new_title:
                data['title'] = new_title
                
                with open(file_path, 'w', encoding='utf-8') as f:
                    json.dump(data, f, ensure_ascii=False, indent=2)
                
                print(f"[OK] –£—Ä–æ–∫ {scene_num:2}: {filename}")
                print(f"     OLD: {old_title}")
                print(f"     NEW: {new_title}")
                updated += 1
            else:
                print(f"[SKIP] –£—Ä–æ–∫ {scene_num:2}: –£–∂–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ")

print("=" * 80)
print(f"[DONE] –û–±–Ω–æ–≤–ª–µ–Ω–æ —Ñ–∞–π–ª–æ–≤: {updated}")
