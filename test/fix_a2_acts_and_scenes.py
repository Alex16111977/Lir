"""
–ò—Å–ø—Ä–∞–≤–ª—è–µ–º –Ω—É–º–µ—Ä–∞—Ü–∏—é A2 —É—Ä–æ–∫–æ–≤:
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ê–ö–¢–´ —Å–æ–≥–ª–∞—Å–Ω–æ —Ç–µ–º–∞—Ç–∏–∫–µ
- –ù–æ–º–µ—Ä–∞ –°–¶–ï–ù = –Ω–æ–º–µ—Ä–∞–º —É—Ä–æ–∫–æ–≤ (1-15)
"""
import json
from pathlib import Path

# –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ A2 —É—Ä–æ–∫–æ–≤ –∞–∫—Ç–∞–º (—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞)
CORRECT_STRUCTURE = {
    # –ì—Ä—É–ø–ø–∞ 1: –°–µ–º–µ–π–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è (–ê–ö–¢ I)
    "01_–û—Ç–µ—Ü_–∏_–¥–æ—á–µ—Ä–∏_A2.json": {"act": "I", "scene": "1", "title": "–û–¢–ï–¶ –ò –î–û–ß–ï–†–ò"},
    "02_–ë—Ä–∞—Ç—å—è_A2.json": {"act": "I", "scene": "2", "title": "–ë–†–ê–¢–¨–Ø"},
    "03_–ü—Ä–µ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ_—Å–µ–º—å–∏_A2.json": {"act": "I", "scene": "3", "title": "–ü–†–ï–î–ê–¢–ï–õ–¨–°–¢–í–û –°–ï–ú–¨–ò"},
    
    # –ì—Ä—É–ø–ø–∞ 2: –≠–º–æ—Ü–∏–∏ –≥–µ—Ä–æ–µ–≤ (–ê–ö–¢ II)
    "04_–ì–Ω–µ–≤_A2.json": {"act": "II", "scene": "4", "title": "–ì–ù–ï–í - –Ø–†–û–°–¢–¨ –õ–ò–†–ê"},
    "05_–°—Ç—Ä–∞—Ö_A2.json": {"act": "II", "scene": "5", "title": "–°–¢–†–ê–• - –£–ñ–ê–° –í –ù–û–ß–ò"},
    "06_–õ—é–±–æ–≤—å_A2.json": {"act": "II", "scene": "6", "title": "–õ–Æ–ë–û–í–¨ –í –¢–†–ê–ì–ï–î–ò–ò"},
    
    # –ì—Ä—É–ø–ø–∞ 3: –î–µ–π—Å—Ç–≤–∏—è –∏ –ø–æ—Å—Ç—É–ø–∫–∏ (–ê–ö–¢ III)
    "07_–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ_A2.json": {"act": "III", "scene": "7", "title": "–ü–£–¢–ï–®–ï–°–¢–í–ò–ï"},
    "08_–ü–æ–∏—Å–∫_A2.json": {"act": "III", "scene": "8", "title": "–ü–û–ò–°–ö"},
    "09_–ü–∏—Å—å–º–∞_A2.json": {"act": "III", "scene": "9", "title": "–ü–ò–°–¨–ú–ê - –ò–ù–¢–†–ò–ì–ò –ò –ü–û–°–õ–ê–ù–ò–Ø"},
    
    # –ì—Ä—É–ø–ø–∞ 4: –ú–µ—Å—Ç–∞ —Å–æ–±—ã—Ç–∏–π (–ê–ö–¢ IV)
    "10_–ó–∞–º–æ–∫_A2.json": {"act": "IV", "scene": "10", "title": "–ó–ê–ú–û–ö - –°–¢–ï–ù–´ –í–õ–ê–°–¢–ò"},
    "11_–õ–µ—Å_A2.json": {"act": "IV", "scene": "11", "title": "–õ–ï–° - –ë–£–†–Ø –ò –ë–ï–ó–£–ú–ò–ï"},
    "12_–¢–µ–º–Ω–∏—Ü–∞_A2.json": {"act": "IV", "scene": "12", "title": "–¢–ï–ú–ù–ò–¶–ê"},
    
    # –ì—Ä—É–ø–ø–∞ 5: –í—Ä–µ–º—è –≤ –ø—å–µ—Å–µ (–ê–ö–¢ V)
    "13_–ü—Ä–æ—à–ª–æ–µ_A2.json": {"act": "V", "scene": "13", "title": "–ü–†–û–®–õ–û–ï"},
    "14_–ù–∞—Å—Ç–æ—è—â–µ–µ_A2.json": {"act": "V", "scene": "14", "title": "–ù–ê–°–¢–û–Ø–©–ï–ï"},
    "15_–ë—É–¥—É—â–µ–µ_A2.json": {"act": "V", "scene": "15", "title": "–ë–£–î–£–©–ï–ï"}
}

a2_dir = Path(r'F:\AiKlientBank\Lir\data\a2')
updated = 0

print("[INFO] –ò—Å–ø—Ä–∞–≤–ª—è–µ–º –∞–∫—Ç—ã –∏ —Å—Ü–µ–Ω—ã –≤ A2 —É—Ä–æ–∫–∞—Ö:")
print("=" * 80)

for filename, correct_info in CORRECT_STRUCTURE.items():
    file_path = a2_dir / filename
    
    if not file_path.exists():
        print(f"[ERROR] –§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω: {filename}")
        continue
    
    with open(file_path, 'r', encoding='utf-8') as f:
        data = json.load(f)
    
    old_title = data.get('title', '')
    
    # –§–æ—Ä–º–∏—Ä—É–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å –∞–∫—Ç–æ–º –∏ —Å—Ü–µ–Ω–æ–π
    new_title = f"üìö –ê–ö–¢ {correct_info['act']}, –°–¶–ï–ù–ê {correct_info['scene']}: {correct_info['title']}"
    
    if old_title != new_title:
        data['title'] = new_title
        
        with open(file_path, 'w', encoding='utf-8') as f:
            json.dump(data, f, ensure_ascii=False, indent=2)
        
        print(f"[OK] {filename}")
        print(f"     OLD: {old_title}")
        print(f"     NEW: {new_title}")
        updated += 1
    else:
        print(f"[SKIP] {filename} - —É–∂–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ")

print("=" * 80)
print(f"[DONE] –û–±–Ω–æ–≤–ª–µ–Ω–æ —Ñ–∞–π–ª–æ–≤: {updated}")
print("\n[STRUCTURE] –§–∏–Ω–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ A2:")
print("  –ì—Ä—É–ø–ø–∞ 1 (–ê–ö–¢ I): –°–µ–º–µ–π–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è - —É—Ä–æ–∫–∏ 1-3")
print("  –ì—Ä—É–ø–ø–∞ 2 (–ê–ö–¢ II): –≠–º–æ—Ü–∏–∏ –≥–µ—Ä–æ–µ–≤ - —É—Ä–æ–∫–∏ 4-6")  
print("  –ì—Ä—É–ø–ø–∞ 3 (–ê–ö–¢ III): –î–µ–π—Å—Ç–≤–∏—è –∏ –ø–æ—Å—Ç—É–ø–∫–∏ - —É—Ä–æ–∫–∏ 7-9")
print("  –ì—Ä—É–ø–ø–∞ 4 (–ê–ö–¢ IV): –ú–µ—Å—Ç–∞ —Å–æ–±—ã—Ç–∏–π - —É—Ä–æ–∫–∏ 10-12")
print("  –ì—Ä—É–ø–ø–∞ 5 (–ê–ö–¢ V): –í—Ä–µ–º—è –≤ –ø—å–µ—Å–µ - —É—Ä–æ–∫–∏ 13-15")
